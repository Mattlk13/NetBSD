VERSION: :1,$s/2020-09-13/2020-09-13/g
ISO:     :1,$s/202009122000Z/202009122000Z/g
NetBSD:  :1,$s/9.99.72/9.99.72/g
PKGSRC:  :1,$s/2020-04-22/2020-09-13/
# Check MD5 filename before post this mail.
# why dont we take off alone.

To: port-armNetBSD.org@localhost
Subject: 2020-09-13-netbsd-raspi-aarch64.img
From: Jun Ebihara <jun@soum.co.jp>

I've updated 2020-09-13-netbsd-raspi-aarch64.img.gz for RPI4.

http://cdn.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/2020-09-13-aarch64/2020-09-13-netbsd-raspi-aarch64.img.gz
http://cdn.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/2020-09-13-aarch64/MD5

Topics:
- only for RPI4 
  (fill dtb for RPI3?)
- build script
 https://github.com/ebijun/NetBSD/tree/master/RPI/RPIimage/Image/aarch64

RPI4 status:
- boot via UEFI_VER=v1.17
 copy pre-setted RPI_EFI.fd
  serial ,should not set graphical
  disable 3GB -> recognize 4GB
- HDMI: works
- audio: not known
- USB device: works
- bwfm0 Wireless network:?
  (works well on RPI3,not works on RPI4?)
- Pi 4 Bootloader Configuration
  https://www.raspberrypi.org/documentation/hardware/raspberrypi/bcm2711_bootloader_config.md

Update:
- NetBSD-current 9.99.72 evbarm-aarch64 202009122000Z arm64.img from nyftp.
- pkginfo
 https://github.com/ebijun/NetBSD/blob/master/RPI/RPIimage/Image/aarch64/pkginfo
- sysinfo
 https://github.com/ebijun/NetBSD/blob/master/RPI/RPIimage/Image/aarch64/sysinfo

Update from 2020-08-22:
https://github.com/ebijun/NetBSD/commit/e8d136fd8019c489a8510568d28847c54089c756

sysinfo:
 bozohttpd-20200820 dhcpcd-9.2.0 g++-9.3.0 gcc-9.3.0
 NetBSD-9.99.72 sh-20181212-20200912194120Z
 userland-NetBSD-9.99.72/evbarm

pkgsrc:
 cairo-1.16.0nb2 cairo-gobject-1.16.0nb5 curl-7.72.0nb1
 dillo-3.0.5nb8 fltk-1.3.5nb1 fossil-2.12.1 gd-2.3.0nb2
 git-base-2.28.0nb1 glib2-2.64.5 gnutls-3.6.15
 gtk2+-2.24.32nb16 gtk3+-3.24.22nb2 harfbuzz-2.7.2
 icewm-1.2.38pre2nb2 libcups-2.3.3nb5 libffi-3.3nb4
 libgpg-error-1.39 libidn-1.36nb1 libxslt-1.1.34nb3
 lintpkgsrc-4.95nb1 m17n-lib-1.8.0nb3 medit-1.2.0nb15
 mlterm-3.9.0nb3 p11-kit-0.23.21 p5-Authen-SASL-2.16nb8
 p5-Digest-HMAC-1.03nb10 p5-Email-Valid-1.202nb4
 p5-Error-0.17029nb1 p5-GSSAPI-0.28nb11 p5-IO-CaptureOutput-1.1105nb1
 p5-IO-Socket-INET6-2.72nb6 p5-IO-Socket-SSL-2.068 p5-MailTools-2.21nb1
 p5-Mozilla-CA-20200520 p5-Net-DNS-1.26 p5-Net-Domain-TLD-1.75nb4
 p5-Net-IP-1.26nb8 p5-Net-LibIDN-0.12nb12 p5-Net-SMTP-SSL-1.04nb4
 p5-Net-SSLeay-1.88nb1 p5-Socket6-0.29nb2 p5-TimeDate-2.33
 pango-1.46.1 perl-5.32.0nb1 py37-cElementTree-3.7.9
 py37-expat-3.7.9 python27-2.7.18nb2 python37-3.7.9nb1
 qt5-qtbase-5.15.0nb2 qt5-qtx11extras-5.15.0nb2 qt5-qtxmlpatterns-5.15.0nb2
 ruby26-cairo-1.16.6nb1 ruby26-cairo-gobject-3.4.2nb1 ruby26-gtk2-3.4.2nb1
 ruby26-pango-3.4.2nb1 tcsh-6.22.02nb1 tiff-4.1.0nb1 uim-1.8.8nb6
 vlgothic-ttf-20200720 wget-1.20.3nb9

Pkgsrc issues:
- mate/firefox/inkscape works well
- pkgin: upgrade failed
- raspberry-pi userland: compile failed 

Pre-installed packages:
  bash
  tcsh
  vlgothic-ttf
  icewm
  xli
  ruby26-mikutter
  uim
  fossil
  sudo
  git-base
  zsh
  mlterm
  pkg_chk
  lintpkgsrc
  mozilla-rootcerts
  dillo
  medit
  lrzsz

- pre-build packages:
  See /etc/pkg_install.conf
  PKG_PATH=http://cdn.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/aarch64/2020-08-22/

pkgsrc: 
  # cd /usr
  # ftp http://cdn.netbsd.org/pub/pkgsrc/current/pkgsrc.tar.gz
  # ls /usr/pkgsrc                ... check if exists.
  # tar tzvf pkgsrc.tar.gz |head  ... check the archive
  # tar xzvf pkgsrc.tar.gz        ... extract
  # ls /usr/pkgsrc                ... check what extracted
  # pkg_chk -g                    ... List to/usr/pkgsrc/pkgchk.conf
  # (cd /usr/pkgsrc;cvs update -PAd) ... update
  # pkg_chk -un                   ... Update (listup)
  # pkg_chk -u                    ... Update

EEPROM verson:
 Check&update with Raspberry Pi OS (pi:raspberry)
 pi@raspberrypi:~ $ cat /etc/default/rpi-eeprom-update 
 FIRMWARE_RELEASE_STATUS="stable"
 pi@raspberrypi:~ $ sudo rpi-eeprom-update
 BCM2711 detected
 Dedicated VL805 EEPROM detected
 BOOTLOADER: up-to-date
 CURRENT: Thu 16 Jul 15:15:46 UTC 2020 (1594912546)
 LATEST: Thu 16 Jul 15:15:46 UTC 2020 (1594912546)
 FW DIR: /lib/firmware/raspberrypi/bootloader/stable
 VL805: up-to-date
 CURRENT: 000138a1
 LATEST: 000138a1

--
Jun Ebihara
