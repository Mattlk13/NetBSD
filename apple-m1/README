To: port-arm%netbsd.org@localhost
Subject: apple m1 status update (20211022)

Install:
 https://wiki.netbsd.org/ports/evbarm/apple/

Topics:
- boot failed sys/kern/kern_sleepq.c line 227 on NetBSD9.99.90 

boot ok:
NetBSD 9.99.88 (GENERIC64) #0: Wed Sep 15 13:16:57 UTC 2021

boot failed:
NetBSD 9.99.90 (GENERIC64) #0: Fri Oct  8 18:02:57 UTC 2021
NetBSD 9.99.91 (GENERIC64) #0: Tue Oct 12 00:21:34 UTC 2021
        
sys/kern/kern_sleepq.c line 227 on NetBSD9.99.90 on apple m1.
   https://twitter.com/ebijun/status/1446735443987341314

1. Arm MP startup issues -> works well
http://mail-index.netbsd.org/port-arm/2021/10/20/msg007456.html
http://mail-index.netbsd.org/port-arm/2021/10/21/msg007457.html

2. Platform specific fix for ARM MP startup issue -> works well
http://mail-index.netbsd.org/port-arm/2021/10/21/msg007460.html
http://mail-index.netbsd.org/port-arm/2021/10/22/msg007461.html

- libreoffice build failed.
[GAL] backgrounds
[1]   Abort trap (core dumped) (LD_LIBRARY_PATH=${LD_LIBRARY_PATH:+${LD_LIBRA...
terminate called after throwing an instance of 'com::sun::star::uno::RuntimeException'
gmake[1]: *** [/usr/pkgsrc/misc/libreoffice/work.aarch64/libreoffice-7.2.1.2/solenv/gbuild/Gallery.mk:56: /usr/pkgsrc/misc/libreoffice/work.aarch64/libreoffice-7.2.1.2/workdir/Gallery/backgrounds.done] Error 1
gmake: *** [Makefile:287: build] Error 2
 
Hardware:
 Apple Mac mini M1 2020 A2348 
 USB SSD 128GB ELECOM ESD-EC0120GRDR

Filesystem   1G-blocks      Used     Avail %Cap Mounted on
/dev/dk1           109        15        89  14% /
/dev/dk0             0         0         0  35% /boot

ToDo:
- X
 startx -- -depth 30
 http://mail-index.netbsd.org/port-arm/2021/10/21/msg007458.html

- audio
- Wireless LAN

pkgsrc:
- pkgsrc packages:
 http://cdn.netbsd.org/pub/NetBSD/misc/jun/aarch64/aarch64/2021-1/
  pkgin support

System Updates:

sysinfo:
 NetBSD-9.99.92

pkgsrc:
 ImageMagick-7.1.0.8nb2 ap24-php74-7.4.24nb6 apache-2.4.51
 asciidoc-9.1.1 bison-3.8.2 deforaos-pdfviewer-0.1.0nb12
 deforaos-player-0.2.0nb3 digest-20211005 ffmpeg4-4.4nb10
 ffmpegthumbnailer-2.2.2nb2 firefox-92.0.1 firefox-l10n-92.0.1
 gdbus-codegen-2.70.0 glib2-2.70.0 glib2-tools-2.70.0
 gnupg2-2.2.32 gvfs-1.6.7nb56 itstool-2.0.7
 libaom-3.1.3 libfetch-2.39nb1 libgweather-40.0nb3
 libheif-1.12.0nb1 mplayer-share-1.4nb13 mpv-0.33.1nb6
 ncurses-6.2nb4 neon-0.32.1 py27-libxml2-2.9.12nb1
 py27-libxslt-1.1.34nb3 py39-certifi-2021.10.8
 py39-charset-normalizer-2.0.7 py39-cryptodome-3.11.0
 py39-pytz-2021.3 python27-2.7.18nb4 qmmp-1.5.1nb3
 samba-4.13.11 vala-0.54.1 wordpress-5.8
 xfce4-tumbler-0.3.0nb12

Version: 
 NetBSD 9.99.91 (GENERIC) #0: Tue Oct 12 19:57:53 UTC 2021  mkrepro@mkrepro.NetBSD.org:/usr/src/sys/arch/amd64/compile/GENERIC

dmesg:
 https://github.com/ebijun/NetBSD/blob/master/dmesg/aarch64/Apple_Mac_mini_M1_2020

sysinfo:
 https://github.com/ebijun/NetBSD/blob/master/apple-m1/sysinfo

pkginfo:
 https://github.com/ebijun/NetBSD/blob/master/apple-m1/pkginfo

pkgchk.conf:
 https://github.com/ebijun/NetBSD/blob/master/apple-m1/pkgchk.conf
  cp pkgchk.conf /usr/pkgsrc;pkg_add pkg_chk; pkg_chk -au

--
Jun Ebihara
