To: port-arm%netbsd.org@localhost
Subject: pinebook status update (20230825)

NetBSD Arm Bootable Images: NetBSD9/NetBSD-current
 https://nycdn.netbsd.org/pub/arm/

Update:
 openssh-9.3
 clang-15.0.7nb2
 firefox-115.0.2nb1

Problems: 
- pinebook: 
  Using audio interface,rebooting.
  PR port-arm/57111 

- Pinebook Pro graphics noticeably slower since DRM update
  fixed: PR port-arm/56596 
  http://gnats.netbsd.org/cgi-bin/query-pr-single.pl?number=56596 

- gimp with -python option: don't depends on python27 packages
- seamonkey 2.53.10 can't start
- gnucash build failed
- USB Audio 2.0 Support
  http://mail-index.netbsd.org/current-users/2022/06/03/msg042467.html
  https://raw.githubusercontent.com/openbsd/src/master/sys/dev/usb/uaudio.c

Topics:
- Tow-Boot on Pinebook Pro
  https://tow-boot.org/devices/pine64-pinebookPro.html
  need more testing on NetBSD.

- Pinebook GPU
 "I think I am making a bit of progress with the DRM driver 
  for the Pinebook."
  http://mail-index.netbsd.org/port-arm/2022/05/12/msg007650.html

- pkgsrc update as after 2022Q1.
  firefox 98.0.2 and libreoffice 7.3.1.3
  https://twitter.com/ebijun/status/1513773516402790403

- graphical mixer for NetBSD audio.

on pinebook:
 Select a mixer device:
 [*] /dev/mixer0: sun50i-a64-audi  ausoc
 [ ] /dev/mixer1: hdmi-audio  ausoc

on pinebook pro:
XXX: [inputs] tab controls audio output level.
 https://twitter.com/ebijun/status/1395184397599469568

- Audio CD with wavpack
Encode: 
 On Windows: Exact Audio Copy & foobar2000
 On pkgsrc:
 1. pkg_add abcde; pkg_add glyr
    abcde -d /dev/rcd0a -B -o wav -1 -a default,cue
    -> wav,cue,jpg file created.
 2. pkg_add wavpack 
    wavpack -h .wav --write-binary-tag "Cover Art (Front)=@.jpg" -w "cuesheet=@.cue"
    -> wv file created.

Play: 
  qmmp: can play wavpack file with cue. How can I show Cover Art?
   Setting->Output->OSS plugin(liboss.so)

- audio0 input issue
  http://mail-index.netbsd.org/port-arm/2021/02/22/msg007185.html
  "Is audio input from the inbuilt microphone(s) working?  I get "read failed:
  Resource temporarily unavailable" from audiorecord"
  audio0(ausoc1): trigger_input failed: errno=5
  audio0(audoc1): device timeout

pkgsrc:
- works : inkscape,scribus,seamonkey,minitube,mikutter,xournalpp,libreoffice

- firefox 90.0 and libreoffce 7.1.4.2 on NetBSD 9.99.85/aarch64 on pinebook.

 zoom meeting with firefox on NetBSD/aarch64 on pinebook pro 
  with UserAgent switcher addon as Linux.
 Send: Share Screen,camera/USB Camera
 Problem: Can"t show others screen/in-camera.

- pkgin support
 make pkg_summary. and pkgin works.
 cd /usr/pkgsrc/packages/All
 find . -name '*.tgz' -exec pkg_info -X {} \; > pkg_summary
 gzip -f pkg_summary

 pkgsrc packages:
 http://cdn.netbsd.org/pub/NetBSD/misc/jun/aarch64/aarch64/2021-1/

- nono: luna68k/luna88k/x68k emulator
 add /etc/mk.conf
  ACCEPTABLE_LICENSES= nono-license
 cd /usr/pkgsrc/emulators/nono;make ;make package-install
- search soumd mixer GUI to manage mixerctl
 
ToDo:
- 3D acceleration

- Pinebook Pro 
 mate/xfce4/camera/WiFi
 ToDo:  
 - HDMI output via USB-C 
 - Audio output: can't switch speaker & headphone out

- Pinebook
 mate/xfce4/camera/HDMI
 ToDo:
 - internal WiFi

System Updates:

sysinfo:
 libc-12.221 libssh-45.0 NetBSD-10.99.7 openssh-9.3 opensshd-9.3
 libpcap-1.10.4 sh-20220122-20230823122459Z tcpdump-4.99.4
 userland-NetBSD-10.99.7/evbarm

pkgsrc:
 GConf-3.2.3nb17 ImageMagick6-6.9.12.91 SDL2-2.28.2 a2ps-4.15.5nb1
 abseil-20230802.0 alsa-lib-1.2.7.2nb1 arandr-0.1.11nb1
 asciidoc-10.2.0nb5 at-spi2-atk-2.38.0nb2 at-spi2-core-2.44.1
 atk-2.38.0nb1 attica-qt5-5.108.0 avahi-0.8nb6 babl-0.1.106nb1
 boost-build-1.83.0 boost-docs-1.83.0 boost-headers-1.83.0
 boost-jam-1.83.0 boost-libs-1.83.0 caja-dropbox-1.26.0nb3
 cdparanoia-3.0.10.2nb5 clang-15.0.7nb2 cmake-3.27.3
 cmark-0.30.3nb1 coreutils-9.3 curl-8.2.1nb1 dav1d-1.2.1nb1
 dbus-python-common-1.3.2nb1 dconf-0.40.0nb5 desktop-file-utils-0.26nb3
 dhcpcd-10.0.2 dtc-1.7.0nb1 eom-1.26.1nb1 exiv2-0.28.0nb3
 extra-cmake-modules-5.108.0 file-roller-3.38.0nb5 firefox-115.0.2nb1
 firefox52-52.9.0nb57 fmtlib-10.1.0 fontconfig-2.14.2nb2
 gcc8-8.5.0nb1 gdbus-codegen-2.76.4nb1 gdk-pixbuf2-2.42.10nb3
 gdk-pixbuf2-xlib-2.40.2nb3 gedit-3.36.2nb17 gegl-0.4.46nb1
 geocode-glib-3.26.2nb8 gexiv2-0.14.1nb3 gimp-2.10.34nb1
 git-base-2.41.0nb2 glib-networking-2.76.1nb1 glib2-2.76.4nb1
 glib2-tools-2.76.4nb1 glibmm-2.66.6nb1 gmp-6.3.0
 gnome-desktop-2.32.1nb55 gnome-doc-utils-0.20.10nb15 gnutls-3.8.1
 go119-1.19.12 gobject-introspection-1.76.1nb1 googletest-1.14.0
 graphite2-1.3.14nb2 graphviz-8.1.0nb1 gsettings-desktop-schemas-40.0nb2
 gspell-1.8.4 gst-plugins1-bad-1.22.4nb1 gst-plugins1-base-1.22.4nb1
 gstreamer1-1.22.4nb1 gtar-base-1.35 gtk-doc-1.32nb13
 gtk2+-2.24.33nb11 gtk3+-3.24.38nb1 gtksourceview4-4.8.0nb11
 gupnp-1.0.3nb24 harfbuzz-8.0.1nb1 harfbuzz-icu-8.0.1
 ibus-1.5.28nb2 ibus-anthy-1.5.6nb6 icu-73.2nb1 inih-53nb1
 iso-codes-4.11.0nb1 itstool-2.0.7nb3 jbig2dec-0.19nb2
 json-glib-1.6.2nb3 karchive-5.108.0nb1 kauth-5.108.0
 kbookmarks-5.108.0 kcodecs-5.108.0 kcompletion-5.108.0
 kconfig-5.108.0 kconfigwidgets-5.108.0nb1 kcoreaddons-5.108.0
 kcrash-5.108.0 kdbusaddons-5.108.0 kdesignerplugin-5.108.0
 kdewebkit-5.108.0 kdoctools-5.108.0 kglobalaccel-5.108.0
 kguiaddons-5.108.0 ki18n-5.108.0 kiconthemes-5.108.0nb1
 kio-5.108.0 kitemmodels-5.108.0 kitemviews-5.108.0
 kjobwidgets-5.108.0 knotifications-5.108.0 kparts-5.108.0
 kplotting-5.108.0 kservice-5.108.0nb1 ktextwidgets-5.108.0nb1
 kwallet-5.108.0nb1 kwidgetsaddons-5.108.0 kwindowsystem-5.108.0
 kxmlgui-5.108.0nb1 ldb-2.7.2nb1 libLLVM-13.0.1nb4
 libappindicator-12.10.0nb17 libdazzle-3.38.0nb10
 libdbusmenu-qt5-0.9.3.16.04.20160218nb21 libepoxy-1.5.10nb1
 libgweather-40.0nb15 libhandy-1.8.0nb4 libimagequant-4.2.0nb1
 libkate-0.4.1nb24 libnotify-0.8.1nb1 libpeas-1.26.0nb8
 libpsl-0.21.2nb1 libpurple-2.14.12nb3 librsvg-2.56.0nb2
 libsigc++-2.10.8nb1 libsixel-1.8.6nb14 libsndfile-1.2.2
 libsoup-2.74.3nb3 libuuid-2.32.1nb2 libva-2.19.0
 libwebp-1.3.1 libwnck3-3.36.0nb5 libxkbcommon-1.5.0nb2
 libxml2-2.10.4nb2 libxslt-1.1.38nb1 libzip-1.10.0nb1
 llvm-15.0.7nb2 mate-1.26.0nb5 medit-1.2.0nb25
 meson-1.2.1nb1 mm-common-1.0.5nb1 mozilla-rootcerts-1.0.20230720
 mozilla-rootcerts-openssl-2.12 mozjs78-78.15.0nb6
 mozo-1.26.2nb3 mpv-0.36.0 mupdf-1.22.2nb1 netpbm-10.86.34nb5
 nghttp3-0.14.0 nginx-1.24.0nb9 ngtcp2-0.18.0 ninja-build-1.11.1nb1
 nodejs-20.5.1nb1 nss-3.92 openal-soft-1.23.1nb2 openjdk8-1.8.372
 orc-0.4.34nb1 osabi-NetBSD-10.99.7 oxygen-icons-5.108.0
 pango-1.50.14nb1 phonon-qt5-4.11.1nb14 php74-owncloud-10.9.1nb3
 pkgconf-2.0.2 pkgin-23.8.0 pluma-1.26.1nb1 polkit-qt5-0.114.0nb1
 poppler-glib-23.06.0nb1 psutils-3.0.3nb1 pulseaudio-16.1nb5
 py27-enum34-1.1.9 py27-typing-3.7.4.3 py311-OpenSSL-23.2.0
 py311-Pillow-10.0.0 py311-Socks-1.7.1nb1 py311-alabaster-0.7.13
 py311-anytree-2.9.0nb1 py311-atomicwrites-1.4.1 py311-attrs-23.1.0
 py311-babel-2.12.1 py311-cElementTree-3.11.4 py311-cairo-1.24.0
 py311-certifi-2023.7.22 py311-cffi-1.15.1 py311-chardet-5.2.0
 py311-charset-normalizer-3.2.0 py311-cparser-2.21nb1 py311-cryptodome-3.18.0
 py311-cryptography-41.0.3 py311-cython-0.29.36 py311-dbus-1.3.2
 py311-dns-2.4.2 py311-docutils-0.20.1 py311-ecdsa-0.18.0
 py311-expat-3.11.4nb1 py311-gobject3-3.44.1
 py311-gyp-0.1pre20210830.d6c5dd51dc3a60bf4ff32a5256713690a1a10376nb2
 py311-idna-3.4 py311-imagesize-1.4.1 py311-importlib-metadata-6.8.0
 py311-iso8601-2.0.0 py311-jinja2-3.1.2 py311-libxml2-2.10.4nb1
 py311-libxslt-1.1.38 py311-lxml-4.9.3 py311-mako-1.2.4
 py311-markdown-3.4.4 py311-markupsafe-2.1.3 py311-more-itertools-9.1.0
 py311-numpy-1.25.2 py311-olefile-0.46nb1 py311-packaging-23.1
 py311-pbr-5.11.1 py311-pdf-3.14.0 py311-pip-23.2.1
 py311-pluggy-1.2.0 py311-pspdfutils-3.0.8 py311-puremagic-1.15
 py311-pygments-2.16.1 py311-pyparsing-3.1.1 py311-pytz-2023.3
 py311-requests-2.31.0 py311-roman-4.1 py311-scour-0.38.2nb3
 py311-serial-3.5nb2 py311-setuptools-68.0.0 py311-setuptools_scm-7.1.0
 py311-six-1.16.0nb1 py311-snowballstemmer-2.2.0nb1 py311-sphinx-7.1.2
 py311-sphinxcontrib-applehelp-1.0.4 py311-sphinxcontrib-devhelp-1.0.2nb1
 py311-sphinxcontrib-htmlhelp-2.0.1 py311-sphinxcontrib-jsmath-1.0.1nb1
 py311-sphinxcontrib-qthelp-1.0.3nb1
 py311-sphinxcontrib-serializinghtml-1.1.5nb1 py311-sqlite3-3.11.4nb24
 py311-typing-extensions-4.7.1 py311-urllib3-2.0.4 py311-wcwidth-0.2.6
 py311-zipp-3.16.2 py311-zstandard-0.21.0 py39-tomli-2.0.1
 python311-3.11.4nb2 qca2-qt5-2.3.5nb4 qt5-qtdeclarative-5.15.10nb1
 qt5-qtscript-5.15.10 qt5-qtspeech-5.15.10 qt5-qtwayland-5.15.10
 qt5-qtwebkit-5.212.0.alpha4nb20 re2c-3.0nb1 rhash-1.4.4
 ruby31-addressable-2.8.5 ruby31-atk-4.1.9 ruby31-cairo-gobject-4.1.9
 ruby31-gdk3-4.1.9 ruby31-gdk_pixbuf2-4.1.9 ruby31-gio2-4.1.9
 ruby31-glib2-4.1.9 ruby31-gobject-introspection-4.1.9
 ruby31-gtk3-4.1.9 ruby31-mikutter-5.0.5 ruby31-mini_portile2-2.8.4
 ruby31-native-package-installer-1.1.8 ruby31-pango-4.1.9
 ruby31-public_suffix-5.0.3 rust-1.70.0nb1 samba-4.18.5nb1
 seamonkey-2.53.16nb3 shared-mime-info-2.2nb3 solid-5.108.0
 sonnet-5.108.0 spdlog-1.12.0nb2 sudo-1.9.14p3 svt-av1-1.5.0
 taglib-1.13.1nb1 talloc-2.4.1nb1 tdb-1.4.9nb1 telepathy-glib-0.24.1nb30
 tevent-0.14.1nb1 tiff-4.5.1nb1 unixodbc-2.3.12 vala-0.56.10
 vte-0.28.1nb31 vte3-0.72.2nb1 waf-2.0.25nb1
 xfce4-settings-4.18.3nb1 xfce4-terminal-1.1.0
 xkeyboard-config-2.39nb1 xxhash-0.8.2 youtube-dl-20211217nb5
 zxing-cpp-2.1.0 zziplib-0.13.72nb2

System Updates:
https://github.com/ebijun/NetBSD/commit/2e07db8ce05b7f8dc77b266b9ba98a7cc8dfd170

Tips:
- System Clocks
 % sysctl -a |grep freq

 Install pkgsrc/sysutils/estd from pkgsrc and start it on bootup 
 for automatic up-/downscaling.

pinebook:
 machdep.cpufreq.cpu0.available = 1152 1104 1008 816 648 408
 # sysctl -w machdep.cpufreq.cpu0.target=1152

pinebook-pro:
 machdep.cpufreq.cpu0.available = 1416 1200 1008 816 600 408
 machdep.cpufreq.cpu4.available = 2000 1800 1608 1416 1200 1008 816 600 408
 # sysctl -w machdep.cpufreq.cpu0.target=1416
 # sysctl -w machdep.cpufreq.cpu4.target=2000

- Battery Status
  envstat 
  xbattbar
XXX: link from dbus or mate-power-manager? 

- HDMI port works on pinebook.
 Connect display to pinebook HDMI port
 # pkg_add arandr
 % arandr

- mate: pkgsrc/meta-pkgs/mate
 https://twitter.com/ebijun/status/1086814579647102976
 pkg_add mate
 echo "mate-session" >> .xinitrc
 startx

- ibus 
 export XMODIFIERS=@im=ibus

- Add eDP transmitter and enable display pipeline
 http://mail-index.netbsd.org/source-changes/2019/02/03/msg103047.html
 arandr works well: display up-side down
 https://twitter.com/ebijun/status/1092885154127724544

- keymapping: [Shift][<>] on 11inch
 https://wiki.netbsd.org/ports/evbarm/allwinner/#index3h2

- replace AC Adapter for heavy load
 Anker PowerPort10 A2133+USB DC Cable with 3.5mm/1.35mm connecter
 USB-C laptop charger from HP

- USB Wifi: urtwn0/run0 works 
 urtwn0: I-O DATA DEVICE, INC. (0x4bb) WN-G150UM (0x94c)
 pinebook: internal Wi-Fi not supported
 pinebook pro: internal bwfm0 works,sometimes hangs


Version: 
 NetBSD 10.99.7 (GENERIC64) #0: Wed Aug 23 12:24:59 UTC 2023  mkrepro@mkrepro.NetBSD.org:/usr/src/sys/arch/evbarm/compile/GENERIC64

dmesg:
 https://github.com/ebijun/NetBSD/blob/master/dmesg/aarch64/pinebook
 https://github.com/ebijun/NetBSD/blob/master/dmesg/aarch64/pinebook-pro

System image: dd to eMMC.
 http://www.invisible.ca/arm/

 pinebook-pro:
 1. Insert microSD, boot (Linux from eMMC comes up), 
 2. hit "Restart", 
 3. It will boot from microSD. 
 4. dd'ing to eMMC for installation, the eMMC is faster
- eMMC can disable with switch inside,and boot MicroSD.

 Getting Started with NetBSD on the Pinebook Pro by Benny Siegert 
 https://bentsukun.ch/posts/pinebook-pro-netbsd/

sysinfo:
 https://github.com/ebijun/NetBSD/blob/master/pinebook/Update/sysinfo

pkginfo:
 https://github.com/ebijun/NetBSD/blob/master/pinebook/Update/pkginfo

pkgchk.conf:
 https://github.com/ebijun/NetBSD/blob/master/pinebook/Update/pkgchk.conf
  cp pkgchk.conf /usr/pkgsrc;pkg_add pkg_chk; pkg_chk -au

--
Jun Ebihara
