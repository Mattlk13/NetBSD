To: port-arm%netbsd.org@localhost
Subject: pinebook status update (20240121)

NetBSD Arm Bootable Images: NetBSD9/NetBSD10/NetBSD-current
 https://www.armbsd.org

Update:
 openssh-9.6
 boost-libs-1.84.0
 cmake-3.28.1
 icu-74.2
 libreoffice-7.6.4.1nb1
 mate-1.26.1nb7
 nodejs-21.6.0
 nss-3.96.1
 perl-5.38.2
 python311-3.11.7
 rust-1.74.1nb1
 samba-4.19.4

Problems: 
- pinebook: 
  Using audio interface,rebooting.
  PR port-arm/57111 

- Pinebook Pro graphics noticeably slower since DRM update
  fixed: PR port-arm/56596 
  http://gnats.netbsd.org/cgi-bin/query-pr-single.pl?number=56596 

- gimp with -python option: don't depends on python27 packages
- seamonkey 2.53.10 can't start
- gnucash build failed
- USB Audio 2.0 Support
  http://mail-index.netbsd.org/current-users/2022/06/03/msg042467.html
  https://raw.githubusercontent.com/openbsd/src/master/sys/dev/usb/uaudio.c

Topics:
- Tow-Boot on Pinebook Pro
  https://tow-boot.org/devices/pine64-pinebookPro.html
  need more testing on NetBSD.

- Pinebook GPU
 "I think I am making a bit of progress with the DRM driver 
  for the Pinebook."
  http://mail-index.netbsd.org/port-arm/2022/05/12/msg007650.html

- pkgsrc update as after 2022Q1.
  firefox 98.0.2 and libreoffice 7.3.1.3
  https://twitter.com/ebijun/status/1513773516402790403

- graphical mixer for NetBSD audio.

on pinebook:
 Select a mixer device:
 [*] /dev/mixer0: sun50i-a64-audi  ausoc
 [ ] /dev/mixer1: hdmi-audio  ausoc

on pinebook pro:
XXX: [inputs] tab controls audio output level.
 https://twitter.com/ebijun/status/1395184397599469568

- Audio CD with wavpack
Encode: 
 On Windows: Exact Audio Copy & foobar2000
 On pkgsrc:
 1. pkg_add abcde; pkg_add glyr
    abcde -d /dev/rcd0a -B -o wav -1 -a default,cue
    -> wav,cue,jpg file created.
 2. pkg_add wavpack 
    wavpack -h .wav --write-binary-tag "Cover Art (Front)=@.jpg" -w "cuesheet=@.cue"
    -> wv file created.

Play: 
  qmmp: can play wavpack file with cue. How can I show Cover Art?
   Setting->Output->OSS plugin(liboss.so)

- audio0 input issue
  http://mail-index.netbsd.org/port-arm/2021/02/22/msg007185.html
  "Is audio input from the inbuilt microphone(s) working?  I get "read failed:
  Resource temporarily unavailable" from audiorecord"
  audio0(ausoc1): trigger_input failed: errno=5
  audio0(audoc1): device timeout

pkgsrc:
- works : inkscape,scribus,seamonkey,minitube,mikutter,xournalpp,libreoffice

- firefox 90.0 and libreoffce 7.1.4.2 on NetBSD 9.99.85/aarch64 on pinebook.

 zoom meeting with firefox on NetBSD/aarch64 on pinebook pro 
  with UserAgent switcher addon as Linux.
 Send: Share Screen,camera/USB Camera
 Problem: Can"t show others screen/in-camera.

- pkgin support
 make pkg_summary. and pkgin works.
 cd /usr/pkgsrc/packages/All
 find . -name '*.tgz' -exec pkg_info -X {} \; > pkg_summary
 gzip -f pkg_summary

 pkgsrc packages:
 http://cdn.netbsd.org/pub/NetBSD/misc/jun/aarch64/aarch64/2021-1/

- nono: luna68k/luna88k/x68k emulator
 add /etc/mk.conf
  ACCEPTABLE_LICENSES= nono-license
 cd /usr/pkgsrc/emulators/nono;make ;make package-install
- search soumd mixer GUI to manage mixerctl
 
ToDo:
- 3D acceleration

- Pinebook Pro 
 mate/xfce4/camera/WiFi
 ToDo:  
 - HDMI output via USB-C 
 - Audio output: can't switch speaker & headphone out

- Pinebook
 mate/xfce4/camera/HDMI
 ToDo:
 - internal WiFi

System Updates:


sysinfo:
 dhcpcd-10.0.6 libssh-46.1 openssh-9.6 opensshd-9.6 sh-20220122-20240118144209Z
 tzdata-2023dgtz

pkgsrc:
 ImageMagick-7.1.1.26 ImageMagick6-6.9.13.3 SDL-1.2.15nb42 aspell-0.60.8.1
 atril-1.26.1nb8 autoconf-2.72 bash-5.2.26 blas-3.12.0 boost-build-1.84.0
 boost-docs-1.84.0 boost-headers-1.84.0 boost-jam-1.84.0 boost-libs-1.84.0
 bsdtar-3.7.2 cblas-3.12.0 cmake-3.28.1 cmocka-1.1.7 curl-8.5.0
 deforaos-pdfviewer-0.1.0nb23 desktop-file-utils-0.26nb4 dhcpcd-10.0.6
 enchant2-2.6.5 exempi-2.5.2nb7 faad2-2.11.1 ffmpeg6-6.1.1 fmtlib-10.2.1
 fontconfig-2.15.0 fossil-2.23 gettext-0.22.4 gettext-asprintf-0.22.4
 gettext-lib-0.22.4 gettext-m4-0.22.4 gettext-tools-0.22.4 gimp-2.10.36nb5
 gnutls-3.8.3 go-1.21.6 go-bin-1.21.5 go120-1.20.13 go121-1.21.6
 graphviz-8.1.0nb8 gst-plugins1-bad-1.22.8 gst-plugins1-base-1.22.8
 gstreamer1-1.22.8 gtk4-4.12.4nb1 gumbo-parser-0.12.1 icu-74.2 imake-1.0.10
 itstool-2.0.7nb5 jasper-4.1.2 kdelibs4-4.14.38nb37 kfilemetadata-4.14.3nb73
 lapack-3.12.0 lapacke-3.12.0 lcms2-2.16 libabw-0.1.3nb19 libaom-3.8.0
 libarchive-3.7.2 libatomic_ops-7.8.2 libcares-1.25.0 libcdr-0.1.7nb12
 libclucene-2.3.3.4nb25 libcmis-0.5.2nb25 libde265-1.0.15 libe-book-0.1.3nb28
 libebml-1.4.5 libepubgen-0.1.1nb8 libetonyek-0.1.10nb12 libfetch-2.40
 libfreehand-0.1.2nb20 libgpg-error-1.47nb1 libheif-1.17.6 libixion-0.18.1nb1
 libkactivities4-4.13.3nb36 liblangtag-0.6.7 libmateweather-1.26.3
 libmspub-0.1.4nb27 libmwaw-0.3.21nb3 libodfgen-0.1.7nb8 libpagemaker-0.0.4nb14
 libplacebo-6.338.1 libpsl-0.21.5 libqxp-0.0.2nb21 libreoffice-7.6.4.1nb1
 librevenge-0.0.4nb19 libstaroffice-0.0.7nb8 libusb-compat-0.1.8
 libvisio-0.1.7nb22 libwpd-0.10.3nb8 libwpg-0.3.3nb11 libwps-0.4.12nb7
 libxml2-2.10.4nb6 libzmf-0.0.2nb29 mate-1.26.1nb7 mate-media-1.26.2
 mate-panel-1.26.4 mdds-2.1.1nb1 mdds1.2-1.3.1nb14 meson-1.3.1 mkvtoolnix-82.0
 mpv-0.37.0 mujs-1.3.4 mupdf-1.23.7nb1 nodejs-21.6.0 nss-3.96.1 orcus-0.18.1nb1
 p5-Clone-0.46nb1 p5-Crypt-SSLeay-0.72nb13 p5-Encode-Locale-1.05nb9
 p5-File-Listing-6.16 p5-HTML-Parser-3.81nb1 p5-HTML-Tagset-3.20nb15
 p5-HTTP-CookieJar-0.014nb1 p5-HTTP-Cookies-6.11 p5-HTTP-Daemon-6.16nb1
 p5-HTTP-Date-6.06 p5-HTTP-Message-6.45 p5-HTTP-Negotiate-6.01nb12
 p5-IO-HTML-1.004nb3 p5-IO-Socket-SSL-2.084 p5-LWP-MediaTypes-6.04nb4
 p5-LWP-Protocol-https-6.11 p5-Mozilla-CA-20231213 p5-Net-DNS-1.42
 p5-Net-HTTP-6.23 p5-Net-SSLeay-1.94 p5-Path-Class-0.37nb7 p5-Try-Tiny-0.31nb1
 p5-URI-5.21 p5-WWW-RobotRules-6.02nb12 p5-XML-Parser-2.47 p5-libwww-6.73
 perl-5.38.2 pkg_install-20211115nb2 pkgin-23.8.1nb3 poppler-24.01.0
 poppler-cpp-24.01.0 poppler-includes-24.01.0 poppler-utils-24.01.0
 protobuf-25.2 py311-Pillow-10.2.0 py311-alabaster-0.7.16 py311-attrs-23.2.0
 py311-babel-2.14.0 py311-cryptodome-3.20.0 py311-cython-3.0.8 py311-glad2-2.0.4
 py311-importlib-metadata-7.0.1 py311-jinja2-3.1.3 py311-libxml2-2.10.4nb4
 py311-lxml-5.1.0 py311-markdown-3.5.2 py311-markupsafe-2.1.4
 py311-more-itertools-10.2.0 py311-numpy-1.26.3 py311-olefile-0.47
 py311-pbr-6.0.0 py311-pdf-3.17.4 py311-pip-23.3.2 py311-setuptools-69.0.3nb1
 py311-sphinxcontrib-applehelp-1.0.8 py311-sphinxcontrib-devhelp-1.0.6
 py311-sphinxcontrib-htmlhelp-2.0.5 py311-sphinxcontrib-qthelp-1.0.7
 py311-sphinxcontrib-serializinghtml-1.1.10 py311-typing-extensions-4.9.0
 py311-wcwidth-0.2.13 python311-3.11.7 qt5-qtbase-5.15.12
 qt5-qtdeclarative-5.15.12 qt5-qtlocation-5.15.12 qt5-qtmultimedia-5.15.12
 qt5-qtscript-5.15.12 qt5-qtsensors-5.15.12 qt5-qtserialport-5.15.12
 qt5-qtspeech-5.15.12 qt5-qtsvg-5.15.12 qt5-qttools-5.15.12
 qt5-qtwayland-5.15.12 qt5-qtwebchannel-5.15.12 qt5-qtwebsockets-5.15.12
 qt5-qtx11extras-5.15.12 qt5-qtxmlpatterns-5.15.12 qt6-qtbase-6.6.1nb1
 qt6-qtdeclarative-6.6.1 qt6-qtmultimedia-6.6.1 qt6-qtquick3d-6.6.1
 qt6-qtquicktimeline-6.6.1 qt6-qtshadertools-6.6.1 qt6-qtsvg-6.6.1
 rclone-1.65.0nb1 ruby31-pkg-config-1.5.6 ruby31-unf_ext-0.0.9.1 rust-1.74.1nb1
 samba-4.19.4 seamonkey-2.53.16nb9 shared-mime-info-2.4
 source-highlight-3.1.9nb7 spdlog-1.13.0 sqlite3-3.45.0 strigi-0.7.8nb56
 svt-av1-1.8.0 tex-uptex-2023 tiff-4.6.0nb3 vte3-0.74.2
 vulkan-headers-1.3.224nb1 waf-2.0.26 xfce4-settings-4.18.4 xfce4-thunar-4.18.10
 xfce4-tumbler-4.18.2nb1 xkanon-090830nb9 xterm-389 zxing-cpp-2.2.1

System Updates:
https://github.com/ebijun/NetBSD/commit/2e07db8ce05b7f8dc77b266b9ba98a7cc8dfd170

Tips:
- System Clocks
 % sysctl -a |grep freq

 Install pkgsrc/sysutils/estd from pkgsrc and start it on bootup 
 for automatic up-/downscaling.

pinebook:
 machdep.cpufreq.cpu0.available = 1152 1104 1008 816 648 408
 # sysctl -w machdep.cpufreq.cpu0.target=1152

pinebook-pro:
 machdep.cpufreq.cpu0.available = 1416 1200 1008 816 600 408
 machdep.cpufreq.cpu4.available = 2000 1800 1608 1416 1200 1008 816 600 408
 # sysctl -w machdep.cpufreq.cpu0.target=1416
 # sysctl -w machdep.cpufreq.cpu4.target=2000

- Battery Status
  envstat 
  xbattbar
XXX: link from dbus or mate-power-manager? 

- HDMI port works on pinebook.
 Connect display to pinebook HDMI port
 # pkg_add arandr
 % arandr

- mate: pkgsrc/meta-pkgs/mate
 https://twitter.com/ebijun/status/1086814579647102976
 pkg_add mate
 echo "mate-session" >> .xinitrc
 startx

- ibus 
 export XMODIFIERS=@im=ibus

- Add eDP transmitter and enable display pipeline
 http://mail-index.netbsd.org/source-changes/2019/02/03/msg103047.html
 arandr works well: display up-side down
 https://twitter.com/ebijun/status/1092885154127724544

- keymapping: [Shift][<>] on 11inch
 https://wiki.netbsd.org/ports/evbarm/allwinner/#index3h2

- replace AC Adapter for heavy load
 Anker PowerPort10 A2133+USB DC Cable with 3.5mm/1.35mm connecter
 USB-C laptop charger from HP

- USB Wifi: urtwn0/run0 works 
 urtwn0: I-O DATA DEVICE, INC. (0x4bb) WN-G150UM (0x94c)
 pinebook: internal Wi-Fi not supported
 pinebook pro: internal bwfm0 works,sometimes hangs


Version: 
 NetBSD 10.99.10 (GENERIC64) #0: Thu Jan 18 14:42:09 UTC 2024  mkrepro@mkrepro.NetBSD.org:/usr/src/sys/arch/evbarm/compile/GENERIC64

dmesg:
 https://github.com/ebijun/NetBSD/blob/master/dmesg/aarch64/pinebook
 https://github.com/ebijun/NetBSD/blob/master/dmesg/aarch64/pinebook-pro

System image: dd to eMMC.
 http://www.invisible.ca/arm/

 pinebook-pro:
 1. Insert microSD, boot (Linux from eMMC comes up), 
 2. hit "Restart", 
 3. It will boot from microSD. 
 4. dd'ing to eMMC for installation, the eMMC is faster
- eMMC can disable with switch inside,and boot MicroSD.

 Getting Started with NetBSD on the Pinebook Pro by Benny Siegert 
 https://bentsukun.ch/posts/pinebook-pro-netbsd/

sysinfo:
 https://github.com/ebijun/NetBSD/blob/master/pinebook/Update/sysinfo

pkginfo:
 https://github.com/ebijun/NetBSD/blob/master/pinebook/Update/pkginfo

pkgchk.conf:
 https://github.com/ebijun/NetBSD/blob/master/pinebook/Update/pkgchk.conf
  cp pkgchk.conf /usr/pkgsrc;pkg_add pkg_chk; pkg_chk -au

--
Jun Ebihara
